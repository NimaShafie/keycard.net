<!-- Views/ForgotPasswordView.axaml -->
<UserControl
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vms="clr-namespace:KeyCard.Desktop.ViewModels"
    xmlns:chrome="clr-namespace:KeyCard.Desktop.Infrastructure.UI"
    x:Class="KeyCard.Desktop.Views.ForgotPasswordView"
    x:DataType="vms:ForgotPasswordViewModel"
    chrome:ViewChrome.TopBarVisible="False">

  <UserControl.Styles>
    <!-- Animated gradient background -->
    <Style Selector="Border#AnimatedBackground">
      <Style.Animations>
        <Animation Duration="0:0:8" IterationCount="Infinite">
          <KeyFrame Cue="0%">
            <Setter Property="Background">
              <Setter.Value>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                  <GradientStop Color="#1a0033" Offset="0"/>
                  <GradientStop Color="#330066" Offset="0.5"/>
                  <GradientStop Color="#0f0f12" Offset="1"/>
                </LinearGradientBrush>
              </Setter.Value>
            </Setter>
          </KeyFrame>
          <KeyFrame Cue="33%">
            <Setter Property="Background">
              <Setter.Value>
                <LinearGradientBrush StartPoint="0.3,0.3" EndPoint="0.7,1">
                  <GradientStop Color="#0f0f12" Offset="0"/>
                  <GradientStop Color="#1a0033" Offset="0.5"/>
                  <GradientStop Color="#330066" Offset="1"/>
                </LinearGradientBrush>
              </Setter.Value>
            </Setter>
          </KeyFrame>
          <KeyFrame Cue="66%">
            <Setter Property="Background">
              <Setter.Value>
                <LinearGradientBrush StartPoint="1,0" EndPoint="0,1">
                  <GradientStop Color="#330066" Offset="0"/>
                  <GradientStop Color="#0f0f12" Offset="0.5"/>
                  <GradientStop Color="#1a0033" Offset="1"/>
                </LinearGradientBrush>
              </Setter.Value>
            </Setter>
          </KeyFrame>
          <KeyFrame Cue="100%">
            <Setter Property="Background">
              <Setter.Value>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                  <GradientStop Color="#1a0033" Offset="0"/>
                  <GradientStop Color="#330066" Offset="0.5"/>
                  <GradientStop Color="#0f0f12" Offset="1"/>
                </LinearGradientBrush>
              </Setter.Value>
            </Setter>
          </KeyFrame>
        </Animation>
      </Style.Animations>
    </Style>

    <!-- Link button style -->
    <Style Selector="Button.link-button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Foreground" Value="#B388FF"/>
      <Setter Property="FontSize" Value="13"/>
      <Setter Property="Padding" Value="4,2"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Height" Value="NaN"/>
    </Style>
    <Style Selector="Button.link-button:pointerover">
      <Setter Property="Foreground" Value="#D1B3FF"/>
    </Style>
  </UserControl.Styles>

  <Grid>
    <!-- Animated gradient background -->
    <Border x:Name="AnimatedBackground"/>

    <!-- Forgot Password card -->
    <Border Classes="login-card"
            Width="460"
            HorizontalAlignment="Center"
            VerticalAlignment="Center">

      <StackPanel Spacing="20">
        <!-- Back button -->
        <Button Content="← Back to Login"
                Classes="link-button"
                Command="{Binding BackToLoginCommand}"
                HorizontalAlignment="Left"/>

        <!-- Title -->
        <StackPanel Spacing="8">
          <TextBlock Text="Reset Password"
                     FontSize="28"
                     FontWeight="Bold"
                     HorizontalAlignment="Center"
                     Foreground="White"/>
          <TextBlock Text="Enter your email to receive a reset link"
                     FontSize="14"
                     HorizontalAlignment="Center"
                     Opacity="0.8"
                     Foreground="White"/>
        </StackPanel>

        <!-- Form -->
        <StackPanel Spacing="14" Margin="0,12,0,0">
          <TextBox Watermark="Email Address"
                   Text="{Binding Email}"
                   Height="42"
                   Padding="14,0"
                   CornerRadius="8"/>

          <!-- Success message -->
          <Border Background="#1F3D2F"
                  BorderBrush="#4CAF50"
                  BorderThickness="1"
                  CornerRadius="6"
                  Padding="12,8"
                  IsVisible="{Binding IsSuccess}">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <TextBlock Text="✓"
                         Foreground="#4CAF50"
                         FontSize="16"
                         FontWeight="Bold"
                         VerticalAlignment="Center"/>
              <TextBlock Text="{Binding Message}"
                         Foreground="#B3FFB3"
                         FontSize="12"
                         TextWrapping="Wrap"
                         VerticalAlignment="Center"/>
            </StackPanel>
          </Border>

          <!-- Error message -->
          <Border Background="#3D1F1F"
                  BorderBrush="#FF6B6B"
                  BorderThickness="1"
                  CornerRadius="6"
                  Padding="12,8"
                  IsVisible="{Binding Message, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
            <StackPanel Orientation="Horizontal" Spacing="8"
                        IsVisible="{Binding !IsSuccess}">
              <TextBlock Text="⚠"
                         Foreground="#FF6B6B"
                         FontSize="16"
                         VerticalAlignment="Center"/>
              <TextBlock Text="{Binding Message}"
                         Foreground="#FFB3B3"
                         FontSize="12"
                         TextWrapping="Wrap"
                         VerticalAlignment="Center"/>
            </StackPanel>
          </Border>

          <!-- Send Reset Link button -->
          <Button Content="Send Reset Link"
                  Command="{Binding SendResetLinkCommand}"
                  IsDefault="True"
                  Height="42"
                  FontWeight="SemiBold"
                  CornerRadius="8"
                  Background="#7B1FA2"
                  BorderBrush="#9C27B0"
                  Foreground="White"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  Margin="0,8,0,0">
            <Button.Styles>
              <Style Selector="Button:pointerover">
                <Setter Property="Background" Value="#8E24AA"/>
              </Style>
              <Style Selector="Button:pressed">
                <Setter Property="Background" Value="#6A1B9A"/>
              </Style>
            </Button.Styles>
          </Button>

          <!-- Loading indicator -->
          <ProgressBar IsIndeterminate="True"
                       IsVisible="{Binding IsBusy}"
                       Height="4"
                       Margin="0,8,0,0"
                       Foreground="#B388FF"/>

          <!-- Info text -->
          <TextBlock Text="You will receive an email with instructions to reset your password if an account exists with this email address."
                     FontSize="11"
                     TextWrapping="Wrap"
                     HorizontalAlignment="Center"
                     TextAlignment="Center"
                     Opacity="0.6"
                     Foreground="White"
                     Margin="0,12,0,0"/>
        </StackPanel>

        <!-- Footer -->
        <TextBlock Text="© 2025 KeyCard.NET"
                   FontSize="11"
                   HorizontalAlignment="Center"
                   Opacity="0.5"
                   Foreground="White"
                   Margin="0,16,0,0"/>
      </StackPanel>
    </Border>
  </Grid>
</UserControl>

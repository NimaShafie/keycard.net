@page "/"
@using Microsoft.AspNetCore.Components.Web
@namespace KeyCard.Web.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="~/" />
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="favicon.png"/>
    <component type="typeof(HeadOutlet)" render-mode="ServerPrerendered" />
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Smooth animations */
        * { transition: background-color 0.2s, border-color 0.2s, box-shadow 0.2s; }
        input, select, button { transition: all 0.2s; }
    </style>
</head>
<body class="bg-slate-50 antialiased">
    <component type="typeof(App)" render-mode="ServerPrerendered" />

    <div id="blazor-error-ui" class="fixed bottom-0 left-0 right-0 bg-red-500 text-white p-4 text-center hidden">
        <environment include="Staging,Production">
            An error has occurred. This application may no longer respond until reloaded.
        </environment>
        <environment include="Development">
            An unhandled exception has occurred. See browser dev tools for details.
        </environment>
        <a href="" class="underline ml-2">Reload</a>
        <a class="dismiss ml-4 cursor-pointer">✕</a>
    </div>

    <script src="_framework/blazor.server.js"></script>
    <script>
        // Download file from base64
        window.downloadFile = function(base64, fileName, contentType) {
            const linkSource = `data:${contentType};base64,${base64}`;
            const downloadLink = document.createElement("a");
            downloadLink.href = linkSource;
            downloadLink.download = fileName;
            downloadLink.click();
        }
        
        // Open PDF in new tab
        window.openPdfInNewTab = function(base64) {
            const byteCharacters = atob(base64);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            const byteArray = new Uint8Array(byteNumbers);
            const blob = new Blob([byteArray], { type: 'application/pdf' });
            const blobUrl = URL.createObjectURL(blob);
            window.open(blobUrl, '_blank');
        }
    </script>
</body>
</html>
